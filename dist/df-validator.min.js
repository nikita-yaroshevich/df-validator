!function(e){e.module("df.validator.config",[]).value("df.validator.config",{debug:!0}),e.module("df.validator.services",[]),e.module("df.validator",["df.validator.config","df.validator.services"])}(angular),angular.module("df.validator").service("defaultValidationRules",function(e,t,r,n){function a(t,r,n){var a=n.message?n.message:this.message;throw a=e(a)(angular.extend({value:t,object:r},n))}return{required:{message:"This field is required",validate:function(e,t,r){return r=r||{},e&&0!==e.length?!0:a.apply(this,[e,t,r])}},minlength:{message:"Must be at least {{rule}} characters",validate:function(e,t,r){return r=angular.isObject(r)?r:{rule:r},!e||e.length<r.rule?a.apply(this,[e,t,r]):!0}},maxlength:{message:"Must be fewer than {{rule}} characters",validate:function(e,t,r){return r=angular.isObject(r)?r:{rule:r},e&&e.length>r.rule?a.apply(this,[e,t,r]):!0}},equal:{message:"Must be equal",validate:function(e,t,r){r=angular.isObject(r)?r:{rule:r};var i=angular.isObject(r.rule)&&r.rule.field?n(r.rule.field)(t):r.rule,l=r.rule.byValue||!1;return l&&e!==i?a.apply(this,[e,t,r]):l||e==i?!0:a.apply(this,[e,t,r])}},notEqual:{message:"Must be equal",validate:function(e,t,r){r=angular.isObject(r)?r:{rule:r};var i=angular.isObject(r.rule)&&r.rule.field?n(r.rule.field)(t):r.rule,l=r.rule.byValue||!1;return l&&e===i?a.apply(this,[e,t,r]):l||e!=i?!0:a.apply(this,[e,t,r])}},type:{message:"Must be an {{rule}}",validate:function(e,t,r){if(r=angular.isObject(r)?r:{rule:r},!e)return!0;var n=e.toString();return"integer"===r.rule&&n&&!n.match(/^\-*[0-9]+$/)?a.apply(this,[e,t,r]):"number"===r.rule&&n&&!n.match(/^\-*[0-9\.]+$/)?a.apply(this,[e,t,r]):"negative"===r.rule&&n&&!n.match(/^\-[0-9\.]+$/)?a.apply(this,[e,t,r]):"positive"===r.rule&&n&&!n.match(/^[0-9\.]+$/)?a.apply(this,[e,t,r]):"email"===r.rule&&n&&!n.match(/^.+@.+$/)?a.apply(this,[e,t,r]):"phone"===r.rule&&n&&!n.match(/^\+?[0-9\-]+\*?$/)?a.apply(this,[e,t,r]):!0}},pattern:{message:"Invalid format",validate:function(e,t,r){r=angular.isObject(r)?r:{rule:r};var n=r.rule instanceof RegExp?r.rule:new RegExp(r.rule);return e&&!n.exec(e)?a.apply(this,[e,t,r]):!0}},custom:{message:"Invalid value",validate:function(e,t,r){return r.rule(e,t,r)}},lessThan:{message:"This field should be less than {{errorField}}",validate:function(e,t,n){n=angular.isObject(n)?n:{rule:n},n.rule=angular.isString(n.rule)?n.rule.split(/[ ,;]+/).filter(Boolean):[n.rule];var i=parseFloat(e),l=!0;isNaN(i)?l=!1:e=i;for(var u=0;u<n.rule.length;u++){var o=null,s=t[n.rule[u]]||n.rule[u];if(s){if(l){if(isNaN(parseFloat(s)))continue;o=s=parseFloat(s)}if(e>s)return o=null===o?r("humanize")(r("tableize")(n.rule[u])):o,a.apply(this,[e,t,angular.extend(n,{errorField:o})])}}return!0}}}}),function(){"use strict";angular.module("df.validator").service("dfValidationUtils",function(){function e(){}return e.prototype={flattenObjectKeys:function(e){for(var t=[],r=[{object:e,prefix:null}];;){if(0===r.length)break;var n=r.pop(),a=n.prefix?n.prefix+".":"";if("object"==typeof n.object)for(var i in n.object){var l=a+i;t.push(l),r.push({object:n.object[i],prefix:l})}}return t}},new e})}(),angular.module("df.validator").service("formValidator",function(e,t,r,n){function a(){}return a.prototype={$getRulesForFieldName:function(e,t){return t=t.replace(/\[[^\]]+\]/g,".collection.fields"),r(t)(e)},validateAll:function(){throw"Not Implemented"},validateField:function(t,r,a,i,l){l=angular.copy(l);var u=this.$getRulesForFieldName(l,i),o=r||t;if(angular.isString(o)&&(o=o.replace(/\s+$/,"")),!u)return e.resolve();var s=e.defer();return function c(t){function r(t){var r;if(n.has(t.name)){var i=n.get(t.name);try{r=i.validate(o,a,t)}catch(l){return e.reject(l.message||l||i.message)}return angular.isObject(r)&&angular.isFunction(r.then)?r.then(function(t){return e.when(t)},function(t){return e.reject(t||i.message)}):r?e.when(r):e.reject(i.message)}return e.reject("Unknown validation rule with name "+t.name)}var i=t.shift();return r(i).then(function(){return 0===t.length?s.resolve():c(t)}).catch(s.reject)}(u),s.promise}},new a}),angular.module("df.validator").service("objectValidator",function(e,t,r,n){function a(){}return a.prototype={$getRulesForFieldName:function(e,t){return t=t.replace(/\[[^\]]+\]/g,".collection.fields"),r(t)(e)},validateAll:function(e,r){var n=t.flattenObjectKeys(r);return this.validateFields(e,n,r)},validateFields:function(t,n,a){a=angular.copy(a);var i=e.defer(),l=[],u={};return angular.forEach(n,function(e){var n=this.$getRulesForFieldName(a,e);if(n){var i;i=this.validateField(t,e,a),i.then(angular.noop,function(t){r(e).assign(u,t)}),l.push(i)}},this),e.all(l).then(i.resolve,function(){i.reject(u)}),i.promise},validateField:function(t,a,i){var l=this.$getRulesForFieldName(i,a),u=r(a)(t);angular.isString(u)&&(u=u.replace(/\s+$/,""));var o=e.defer();return function s(r){function a(r){var a;if(n.has(r.name)){var i=n.get(r.name),l=r;try{a=i.validate(u,t,l)}catch(o){return e.reject(o||i.message)}return angular.isObject(a)&&angular.isFunction(a.then)?a.then(function(t){return e.when(t)},function(t){return e.reject(t||i.message)}):a?e.when(a):e.reject(i.message)}return e.reject("Unknown validation rule with name "+ruleName)}r.shift();return a(r).then(function(){return 0===r.length?o.resolve():s(r)}).catch(o.reject)}(l),o.promise},isCollectionRequired:function(e,t){var r=this.$getRulesForFieldName(t,e);return r&&r.collection&&r.collection.min&&(angular.isObject(r.collection.min)?r.collection.min.rule:r.collection.min)},isFieldRequired:function(e,t){var r=this.$getRulesForFieldName(t,e);return r&&r.required&&(angular.isObject(r.required)?r.required.rule:r.required)}},new a}),angular.module("df.validator").provider("validator",function(){var e={};this.add=function(t,r){return e[t]=r,this},this.addCollection=function(e){var t=this;angular.forEach(e,function(e,r){t.add(r,e.validators||e)})},this.remove=function(t){return delete e[t],this},this.has=function(t){return void 0!==e[t]},this.get=function(t){return e[t]||{}};var t=this;this.$get=function(e,r,n,a){function i(){}return i.prototype={add:function(e,r){return t.add(e,r),this},remove:function(e){return t.remove(e),this},has:function(e){return t.has(e)},get:function(e){return t.get(e)},addRule:function(e,t){return a.add(e,t),this},removeRule:function(e){return a.remove(e),this},hasRule:function(e){return a.has(e)},getRule:function(e){return a.get(e)},getValidationRules:function(e){return e=angular.isFunction(e)?this.get(e.constructor.name):e,e=angular.isString(e)?this.get(e):e},validate:function(e,t){return t=angular.isObject(t)?t:this.getValidationRules(t||e),r.validateAll(e,t)},validateField:function(e,t,n){var a=angular.isString(t)?[t]:t;return r.validateFields(e,a,this.getValidationRules(n||e))},validateFormField:function(e,t,r,a,i){return n.validateField(e,t,r,a,i)}},new i}}),angular.module("df.validator").service("validatorRulesCollection",function(e,t){var r={};this.add=function(e,t){if(angular.isFunction(t)&&(t={message:"Invalid value",validate:t}),!angular.isFunction(t.validate))throw"Invalid validator object type";return r[e]=t,this},this.remove=function(e){return delete r[e],this},this.has=function(e){return r[e]},this.get=function(e){return r[e]};var n=this;angular.forEach(t,function(e,t){n.add(t,e)})});